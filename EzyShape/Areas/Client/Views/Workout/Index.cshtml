@model ClientWorkoutViewModel
@Html.AntiForgeryToken()


@{
    ViewData["Title"] = "My Programs | Personal Trainer Software for Professionals";
    Layout = null;
}

@using Microsoft.AspNetCore.Identity
@using EzyShape.Infrastructure.Data.Models

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EzyShape | Personal Trainer Software for Professionals</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="~/css/normalize.css">
    <link rel="stylesheet" href="~/css/Client/allWorkouts.css">
    <link rel="stylesheet" href="~/css/Client/bottomNavigation.css">
    <link rel="stylesheet" href="~/css/Client/workoutModal.css">
</head>
<body>

    <!-- Header -->
    <header class="app-header">
        <p>Training</p>
        <div class="sub-nav-div">

            <button class="suv-nav-button sub-active">
                <i class="fa-solid fa-dumbbell"></i>
                Programs
            </button>

            <button class="suv-nav-button">
                <i class="fa fa-history" aria-hidden="true"></i>
                History
            </button>

        </div>
    </header>

    <main>
        <div class="programs-div div-active">

            @foreach (var split in Model.Splits)
            {
                <div class="split-container container" data-id="@split.Id   ">
                    <div class="container-texts-div">
                        <div class="workout-name-div">
                            <p class="workout-name-text">
                                @split.Name
                            </p>
                        </div>
                        <div class="workout-info-div">
                            <i class="fa-solid fa-circle-info"></i>
                        </div>
                    </div>
                </div>
            }
        </div>


        <div class="history-div">
            History
        </div>

    </main>


    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a asp-area="Client" asp-controller="Client" asp-action="Index" class="nav-item">
            <i class="icon-home">
                <i class="fa-solid fa-house"></i>
            </i>
        </a>
        <a href="#" class="nav-item active"><i class="icon-nutrition"><i class="fa-solid fa-dumbbell"></i></i></a>

        <a href="#" class="nav-item"><i class="icon-water"><i class="fa-solid fa-chart-line"></i></i></a>


        <a asp-area="Client" asp-controller="Client" asp-action="Profile" class="nav-item">
            <i class="icon-settings"></i>
            <i class="fa-solid fa-user"></i>
        </a>


    </nav>

    <!-- Fullscreen Bottom Modal -->
    <div id="workoutModal" class="modal-overlay" data-id="" style="display: none;">
        <div class="modal-slider">
            @for(int i=0;i<5;i++)
            {
                <div class="concrete-workout-container">
                    <button class="close-modal-btn" onclick="closeModal()">×</button>
                    <div class="concrete-workout-top-div">
                        <h3 class="concrete-workout-name-text">
                            Workout @i
                        </h3>
                    </div>
                    <div class="concrete-workout-content-div">
                        <div class="exercises-count-div">
                            <p class="exercises-count-text">X Exercises</p>
                        </div>
                        <div class="exercises-list-div">
                            @for(int j=0;j<8;j++)
                            {
                                <div class="exercise-item-div">
                                    <div class="exercise-img">
                                        <img src="img/ClientArea/workoutBackground.jpg" alt="Alternate Text" style="height:20px; width:20px;"/>
                                    </div>
                                    <p class="exercise-name">
                                        Exercise Name
                                    </p>
                                </div>
                            }
                        </div>
                    </div>
                    <div class="workout-bottom-div">
                        <button class="start-workout-button">
                            Start Workout
                        </button>
                    </div>
                </div>
            }
        </div>
    </div>



    <script src="~/js/toggleTrainingSubNavigation.js" asp-append-version="true"></script>
    <
    <script>
        const modal = document.getElementById("workoutModal");
        const slider = modal.querySelector(".modal-slider");
        let currentIndex = 0;
        let startX = 0;

        document.querySelectorAll(".split-container").forEach(container => {
            container.addEventListener("click", () => {
                const id = container.dataset.id;
                modal.dataset.id = id;
                modal.style.display = "block";
                currentIndex = 0;
                slider.style.transform = `translateX(0)`;
            });
        });

        function closeModal() {
            modal.style.display = "none";
        }

        // Swipe functionality
        slider.addEventListener("touchstart", e => {
            startX = e.touches[0].clientX;
        });

        slider.addEventListener("touchend", e => {
            const endX = e.changedTouches[0].clientX;
            const diff = startX - endX;

            if (Math.abs(diff) > 50) {
                if (diff > 0 && currentIndex < 4) currentIndex++; // Swipe Left
                else if (diff < 0 && currentIndex > 0) currentIndex--; // Swipe Right

                slider.style.transform = `translateX(-${currentIndex * 100}vw)`;
            }
        });

        // Optional: close modal when clicking outside (disable if you only want to use the X button)
        modal.addEventListener("click", e => {
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>


</body>
</html>